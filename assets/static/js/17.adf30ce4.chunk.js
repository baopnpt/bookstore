(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[17],{787:function(e,t,a){"use strict";a.r(t);var n=a(8),r=a.n(n),l=a(16),o=a(10),c=a(11),u=a(13),i=a(12),s=a(14),m=a(0),d=a.n(m),h=a(170),p=a(85),f=a(707),g=a(708),v=a(735),E=a(709),b=a(729),y=a(711),D=a(84),k=a(15),O=a(763),C=a(72),F=a.n(C),j=a(232),S=a(50),q=a(48),w=a.n(q),x=["#F44336","#E91E63","#9C27B0","#3F51B5","#2196F3","#009688","#4CAF50","#F57F17"],P=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(i.a)(t).call(this,e))).query=F.a.parse(e.location.search,{ignoreQueryPrefix:!0}),a.state={data:a.query.embed?JSON.parse(a.query.embed):null,pageInfo:null,error:null,startDate:w()().startOf("month").valueOf(),endDate:w()().endOf("month").valueOf(),loading:!0},a}return Object(s.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.loadData()}},{key:"componentWillReceiveProps",value:function(e){this.query=F.a.parse(e.location.search,{ignoreQueryPrefix:!0}),this.loadData()}},{key:"loadData",value:function(){var e=Object(l.a)(r.a.mark((function e(){var t,a,n,l,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.a.getPage(this.query.page);case 2:return t=e.sent,console.log("PAGE INFO",t),this.setState({pageInfo:t,mode:this.query.mode}),e.next=7,k.a.callPageApi(t,"voucherFromSource",{startDate:this.state.startDate,endDate:this.state.endDate});case 7:a=e.sent,[],l=[],o=[],a.sources.map((function(e){var t=[];return a.categories.map((function(e){return t.push({id:e.id,val:0}),null})),l.push({id:e.id,label:e.name,data:t,total:0}),null})),a.data.map((function(e){for(var t=0;t<l.length;t++)if(l[t].id===e.sourceId)for(var a=0;a<l[t].data.length;a++)l[t].data[a].id===e.catId&&(l[t].data[a].val=e.count,l[t].total+=e.count);return null})),console.log(l),n=l.map((function(e){return e.label})),(o=a.categories.map((function(e,t){for(var a=[],n=0;n<l.length;n++)a.push(l[n].data[t].val);return{label:e.name,backgroundColor:x[t],borderWidth:1,data:a}}))).push({label:"T\u1ed5ng",backgroundColor:x[a.categories.length],borderWidth:1,data:l.map((function(e){return e.total}))}),console.log("dataset",o),this.setState({loading:!1,data:{labels:n,datasets:o}});case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onSubmit",value:function(){var e=Object(l.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.onButtonClick();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return d.a.createElement(h.a,null,d.a.createElement(p.a,{md:"12"},d.a.createElement(f.a,null,d.a.createElement(g.a,null,d.a.createElement(v.a,null,d.a.createElement("h3",null,"B\xe1o c\xe1o voucher t\u1eeb ngu\u1ed3n")),d.a.createElement(E.a,null,d.a.createElement("form",null,d.a.createElement(h.a,null,d.a.createElement(p.a,{md:4},d.a.createElement(b.a,null,d.a.createElement(y.a,null,d.a.createElement("b",null,"T\u1eeb ng\xe0y:")),d.a.createElement(j.a.Date,{schema:{},value:this.state.startDate,onChange:function(t){e.setState({startDate:t})}}))),d.a.createElement(p.a,{md:4},d.a.createElement(b.a,null,d.a.createElement(y.a,null,d.a.createElement("b",null,"\u0110\u1ebfn ng\xe0y:")),d.a.createElement(j.a.Date,{schema:{},value:this.state.endDate,onChange:function(t){e.setState({endDate:t})}}))),d.a.createElement(p.a,{md:4},d.a.createElement(D.a,{block:!0,color:"primary",type:"button",onClick:function(){e.loadData()}},"Xem b\xe1o c\xe1o")))),d.a.createElement("div",null,this.state.loading?d.a.createElement(S.a,null):d.a.createElement(O.a,{data:this.state.data,options:{maintainAspectRatio:!0}})))))))}}]),t}(m.Component);t.default=P}}]);